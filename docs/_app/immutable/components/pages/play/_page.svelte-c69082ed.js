import{S as re,i as ne,s as ie,k as w,l as b,m as E,h as m,n as $,b as K,H as le,Q as F,j as He,a1 as se,ag as Pe,W as Ie,Y as Se,Z as Ne,_ as je,f as A,t as G,q as H,a as S,r as P,c as N,p as ae,ac as C,L as u,M as ue,u as M,R as Te,af as Ve,aj as De,v as he,w as _e,x as pe,d as ye,y as de,o as Le,g as $e,ad as qe,a0 as ge}from"../../../chunks/singletons-2be8b19c.js";import{m as fe,g as oe,p as Ae,l as Me}from"../../../chunks/firestore-483174af.js";import{n as Oe}from"../../../chunks/navigation-7beacb47.js";import{g as Be}from"../../../chunks/navigation-1f024a25.js";function Ce(a){let e;return{c(){e=w("div"),this.h()},l(t){e=b(t,"DIV",{class:!0});var s=E(e);s.forEach(m),this.h()},h(){$(e,"class","container")},m(t,s){K(t,e,s),e.innerHTML=a[0],a[2](e)},p(t,[s]){s&1&&(e.innerHTML=t[0])},i:le,o:le,d(t){t&&m(e),a[2](null)}}}function Ye(a,e,t){let s,l;F(a,fe,i=>t(3,s=i)),F(a,oe,i=>t(4,l=i));let{html:o}=e,n;He(()=>n.querySelectorAll(`a[href*="${se}"]`).forEach(i=>i.onclick=p));const p=i=>{var g;i.preventDefault(),i.stopPropagation();const h=(g=i.target)==null?void 0:g.href,_=h.substring(h.indexOf(se)+se.length+1);Oe(l,s,_)};function f(i){Pe[i?"unshift":"push"](()=>{n=i,t(1,n)})}return a.$$set=i=>{"html"in i&&t(0,o=i.html)},[o,n,f]}class Re extends re{constructor(e){super(),ne(this,e,Ye,Ce,ie,{html:0})}}const We=a=>({html:a&1,title:a&2}),me=a=>({html:a[0],title:a[1]});function Ge(a){let e;const t=a[4].default,s=Ie(t,a,a[3],me);return{c(){s&&s.c()},l(l){s&&s.l(l)},m(l,o){s&&s.m(l,o),e=!0},p(l,[o]){s&&s.p&&(!e||o&11)&&Se(s,t,l,l[3],e?je(t,l[3],o,We):Ne(l[3]),me)},i(l){e||(A(s,l),e=!0)},o(l){G(s,l),e=!1},d(l){s&&s.d(l)}}}const Ue="https://en.wikipedia.org/w/api.php?origin=*&action=parse&format=json&page=",Je="Error",Qe="Error, no wikipedia page found";function Ze(a,e,t){let{$$slots:s={},$$scope:l}=e,{wiki:o=""}=e,n="\uC7A0\uC2DC\uB9CC\uC694~",p="Loading...";return a.$$set=f=>{"wiki"in f&&t(2,o=f.wiki),"$$scope"in f&&t(3,l=f.$$scope)},a.$$.update=()=>{a.$$.dirty&4&&fetch(`${Ue}${o!=null?o:"Main_page"}`).then(f=>f.json()).then(f=>{var h,_,g,k;let i=(h=Ae(f,JSON.stringify,JSON.parse))==null?void 0:h.parse;t(1,p=(_=i==null?void 0:i.title)!=null?_:Je),t(0,n=(k=(g=i==null?void 0:i.text["*"])==null?void 0:g.replaceAll("/wiki/",`${se}/`))!=null?k:Qe)})},[n,p,o,l,s]}class ze extends re{constructor(e){super(),ne(this,e,Ze,Ge,ie,{wiki:2})}}function ve(a,e,t){const s=a.slice();return s[4]=e[t],s[6]=t,s}function ke(a,e){let t,s=e[6]+"",l,o,n,p,f=e[4].url+"",i,h;return{key:a,first:null,c(){t=w("div"),l=H(s),o=H(`:
				`),n=w("span"),p=H("/"),i=H(f),h=S(),this.h()},l(_){t=b(_,"DIV",{});var g=E(t);l=P(g,s),o=P(g,`:
				`),n=b(g,"SPAN",{class:!0});var k=E(n);p=P(k,"/"),i=P(k,f),k.forEach(m),h=N(g),g.forEach(m),this.h()},h(){$(n,"class","svelte-15iax1j"),C(n,"link",!0),C(n,"back",e[4].type==="back"),C(n,"destination",e[2].route.includes(e[4].url)),this.first=t},m(_,g){K(_,t,g),u(t,l),u(t,o),u(t,n),u(n,p),u(n,i),u(t,h)},p(_,g){e=_,g&1&&s!==(s=e[6]+"")&&M(l,s),g&1&&f!==(f=e[4].url+"")&&M(i,f),g&1&&C(n,"back",e[4].type==="back"),g&5&&C(n,"destination",e[2].route.includes(e[4].url))},d(_){_&&m(t)}}}function Fe(a){let e,t,s=a[0].name+"",l,o,n,p=a[1]?"Hide":"View History",f,i,h,_=[],g=new Map,k,j,Y,U,L,O=a[0].progress.linksProgressed+"",R,T,q,V,J,I,B=a[0].progress.backNavs+"",Q,D,v,Z=a[0].progress.linkHistory;const d=c=>c[4];for(let c=0;c<Z.length;c+=1){let r=ve(a,Z,c),y=d(r);g.set(y,_[c]=ke(y,r))}return{c(){e=w("section"),t=w("p"),l=H(s),o=S(),n=w("button"),f=H(p),i=S(),h=w("div");for(let c=0;c<_.length;c+=1)_[c].c();k=S(),j=w("div"),Y=H("Links Clicked"),U=S(),L=w("div"),R=H(O),T=S(),q=w("div"),V=H("Times Pressed Back"),J=S(),I=w("div"),Q=H(B),this.h()},l(c){e=b(c,"SECTION",{class:!0});var r=E(e);t=b(r,"P",{class:!0,style:!0});var y=E(t);l=P(y,s),y.forEach(m),o=N(r),n=b(r,"BUTTON",{class:!0});var W=E(n);f=P(W,p),W.forEach(m),i=N(r),h=b(r,"DIV",{class:!0});var X=E(h);for(let ce=0;ce<_.length;ce+=1)_[ce].l(X);X.forEach(m),k=N(r),j=b(r,"DIV",{class:!0});var x=E(j);Y=P(x,"Links Clicked"),x.forEach(m),U=N(r),L=b(r,"DIV",{class:!0});var ee=E(L);R=P(ee,O),ee.forEach(m),T=N(r),q=b(r,"DIV",{class:!0});var te=E(q);V=P(te,"Times Pressed Back"),te.forEach(m),J=N(r),I=b(r,"DIV",{class:!0});var z=E(I);Q=P(z,B),z.forEach(m),r.forEach(m),this.h()},h(){var c;$(t,"class","name svelte-15iax1j"),ae(t,"color",(c=a[0].color)!=null?c:"var(--text)"),$(n,"class","button"),$(h,"class","history svelte-15iax1j"),C(h,"show",a[1]),$(j,"class","stat-name svelte-15iax1j"),$(L,"class","stat svelte-15iax1j"),$(q,"class","stat-name svelte-15iax1j"),$(I,"class","stat svelte-15iax1j"),$(e,"class","svelte-15iax1j")},m(c,r){K(c,e,r),u(e,t),u(t,l),u(e,o),u(e,n),u(n,f),u(e,i),u(e,h);for(let y=0;y<_.length;y+=1)_[y].m(h,null);u(e,k),u(e,j),u(j,Y),u(e,U),u(e,L),u(L,R),u(e,T),u(e,q),u(q,V),u(e,J),u(e,I),u(I,Q),D||(v=[ue(n,"click",a[3]),ue(n,"keydown",a[3])],D=!0)},p(c,[r]){var y;r&1&&s!==(s=c[0].name+"")&&M(l,s),r&1&&ae(t,"color",(y=c[0].color)!=null?y:"var(--text)"),r&2&&p!==(p=c[1]?"Hide":"View History")&&M(f,p),r&5&&(Z=c[0].progress.linkHistory,_=Te(_,r,d,1,c,Z,g,h,Ve,ke,null,ve)),r&2&&C(h,"show",c[1]),r&1&&O!==(O=c[0].progress.linksProgressed+"")&&M(R,O),r&1&&B!==(B=c[0].progress.backNavs+"")&&M(Q,B)},i:le,o:le,d(c){c&&m(e);for(let r=0;r<_.length;r+=1)_[r].d();D=!1,De(v)}}}function Ke(a,e,t){let s;F(a,oe,p=>t(2,s=p));let{player:l}=e,o=!1;const n=()=>{t(1,o=!o)};return a.$$set=p=>{"player"in p&&t(0,l=p.player)},[l,o,s,n]}class Xe extends re{constructor(e){super(),ne(this,e,Ke,Fe,ie,{player:0})}}function we(a,e,t){const s=a.slice();return s[8]=e[t],s}function be(a){let e,t,s,l,o=a[2]?"Won! \u{1F389}":"Lost",n,p,f,i,h=(a[2]?"You":a[3].who)+"",_,g,k,j=a[0].route[a[0].route.length-1].replaceAll("_"," ")+"",Y,U,L,O,R,T,q,V,J,I,B,Q,D=a[0].players,v=[];for(let d=0;d<D.length;d+=1)v[d]=Ee(we(a,D,d));const Z=d=>G(v[d],1,1,()=>{v[d]=null});return{c(){e=w("div"),t=w("div"),s=w("p"),l=H("You "),n=H(o),p=S(),f=w("p"),i=w("span"),_=H(h),g=H(`
				got to
				`),k=w("span"),Y=H(j),U=H(`
				first!`),L=S(),O=w("hr"),R=S(),T=w("div");for(let d=0;d<v.length;d+=1)v[d].c();q=S(),V=w("button"),J=H("Go home"),this.h()},l(d){e=b(d,"DIV",{class:!0});var c=E(e);t=b(c,"DIV",{class:!0});var r=E(t);s=b(r,"P",{});var y=E(s);l=P(y,"You "),n=P(y,o),y.forEach(m),p=N(r),f=b(r,"P",{});var W=E(f);i=b(W,"SPAN",{style:!0});var X=E(i);_=P(X,h),X.forEach(m),g=P(W,`
				got to
				`),k=b(W,"SPAN",{class:!0});var x=E(k);Y=P(x,j),x.forEach(m),U=P(W,`
				first!`),W.forEach(m),L=N(r),O=b(r,"HR",{}),R=N(r),T=b(r,"DIV",{class:!0});var ee=E(T);for(let z=0;z<v.length;z+=1)v[z].l(ee);ee.forEach(m),q=N(r),V=b(r,"BUTTON",{class:!0});var te=E(V);J=P(te,"Go home"),te.forEach(m),r.forEach(m),c.forEach(m),this.h()},h(){ae(i,"color",a[2]?"var(--text)":a[3].color),$(k,"class","destination svelte-1y5xqdc"),$(T,"class","scrollable-stats svelte-1y5xqdc"),$(V,"class","button"),$(t,"class","card svelte-1y5xqdc"),$(e,"class","winner svelte-1y5xqdc")},m(d,c){K(d,e,c),u(e,t),u(t,s),u(s,l),u(s,n),u(t,p),u(t,f),u(f,i),u(i,_),u(f,g),u(f,k),u(k,Y),u(f,U),u(t,L),u(t,O),u(t,R),u(t,T);for(let r=0;r<v.length;r+=1)v[r].m(T,null);u(t,q),u(t,V),u(V,J),I=!0,B||(Q=ue(V,"click",a[4]),B=!0)},p(d,c){if((!I||c&4)&&o!==(o=d[2]?"Won! \u{1F389}":"Lost")&&M(n,o),(!I||c&12)&&h!==(h=(d[2]?"You":d[3].who)+"")&&M(_,h),(!I||c&12)&&ae(i,"color",d[2]?"var(--text)":d[3].color),(!I||c&1)&&j!==(j=d[0].route[d[0].route.length-1].replaceAll("_"," ")+"")&&M(Y,j),c&1){D=d[0].players;let r;for(r=0;r<D.length;r+=1){const y=we(d,D,r);v[r]?(v[r].p(y,c),A(v[r],1)):(v[r]=Ee(y),v[r].c(),A(v[r],1),v[r].m(T,null))}for($e(),r=D.length;r<v.length;r+=1)Z(r);ye()}},i(d){if(!I){for(let c=0;c<D.length;c+=1)A(v[c]);I=!0}},o(d){v=v.filter(Boolean);for(let c=0;c<v.length;c+=1)G(v[c]);I=!1},d(d){d&&m(e),qe(v,d),B=!1,Q()}}}function Ee(a){let e,t;return e=new Xe({props:{player:a[8]}}),{c(){he(e.$$.fragment)},l(s){_e(e.$$.fragment,s)},m(s,l){pe(e,s,l),t=!0},p(s,l){const o={};l&1&&(o.player=s[8]),e.$set(o)},i(s){t||(A(e.$$.fragment,s),t=!0)},o(s){G(e.$$.fragment,s),t=!1},d(s){de(e,s)}}}function xe(a){var i;let e,t,s,l=((i=a[7])!=null?i:"[error]: missing title")+"",o,n,p,f;return p=new Re({props:{html:a[6]}}),{c(){e=w("section"),t=w("h1"),s=w("span"),o=H(l),n=S(),he(p.$$.fragment),this.h()},l(h){e=b(h,"SECTION",{class:!0});var _=E(e);t=b(_,"H1",{id:!0,class:!0});var g=E(t);s=b(g,"SPAN",{class:!0});var k=E(s);o=P(k,l),k.forEach(m),g.forEach(m),n=N(_),_e(p.$$.fragment,_),_.forEach(m),this.h()},h(){$(s,"class","mw-page-title-main"),$(t,"id","firstHeading"),$(t,"class","firstHeading mw-first-heading"),$(e,"class","svelte-1y5xqdc"),C(e,"end",a[2]||a[3].who!=="")},m(h,_){K(h,e,_),u(e,t),u(t,s),u(s,o),u(e,n),pe(p,e,null),f=!0},p(h,_){var k;(!f||_&128)&&l!==(l=((k=h[7])!=null?k:"[error]: missing title")+"")&&M(o,l);const g={};_&64&&(g.html=h[6]),p.$set(g),(!f||_&12)&&C(e,"end",h[2]||h[3].who!=="")},i(h){f||(A(p.$$.fragment,h),f=!0)},o(h){G(p.$$.fragment,h),f=!1},d(h){h&&m(e),de(p)}}}function et(a){let e,t,s,l=(a[2]||a[3].who!=="")&&be(a);return t=new ze({props:{wiki:a[1],$$slots:{default:[xe,({html:o,title:n})=>({6:o,7:n}),({html:o,title:n})=>(o?64:0)|(n?128:0)]},$$scope:{ctx:a}}}),{c(){l&&l.c(),e=S(),he(t.$$.fragment)},l(o){l&&l.l(o),e=N(o),_e(t.$$.fragment,o)},m(o,n){l&&l.m(o,n),K(o,e,n),pe(t,o,n),s=!0},p(o,[n]){o[2]||o[3].who!==""?l?(l.p(o,n),n&12&&A(l,1)):(l=be(o),l.c(),A(l,1),l.m(e.parentNode,e)):l&&($e(),G(l,1,1,()=>{l=null}),ye());const p={};n&2&&(p.wiki=o[1]),n&2252&&(p.$$scope={dirty:n,ctx:o}),t.$set(p)},i(o){s||(A(l),A(t.$$.fragment,o),s=!0)},o(o){G(l),G(t.$$.fragment,o),s=!1},d(o){l&&l.d(o),o&&m(e),de(t,o)}}}function tt(a,e,t){let s,l,o;F(a,fe,i=>t(5,s=i)),F(a,oe,i=>t(0,l=i)),F(a,Me,i=>t(1,o=i));let n=!1,p={who:"",color:""};Le(()=>{if(s.uid===null||s.uid===""||s.gameId===""||o===""){f();return}});const f=()=>{ge(oe,l={id:"",state:"waiting",route:[],players:[]},l),ge(fe,s={...s,gameId:""},s),Be(se)};return a.$$.update=()=>{a.$$.dirty&3&&(o===l.route[l.route.length-1]?t(2,n=!0):l.players.forEach(i=>{i.progress.linkHistory[i.progress.linkHistory.length-1].url===l.route[l.route.length-1]&&t(3,p={who:i.name,color:i.color})}))},[l,o,n,p,f]}class rt extends re{constructor(e){super(),ne(this,e,tt,et,ie,{})}}export{rt as default};
