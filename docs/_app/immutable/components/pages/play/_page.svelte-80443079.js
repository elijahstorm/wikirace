import{S as q,i as z,s as G,k as d,l as w,m as v,h as p,n as b,b as j,H as Q,Q as P,j as oe,a1 as S,ag as ne,W as ae,Y as re,Z as le,_ as ie,f as V,t as C,a as N,v as x,c as T,w as ee,x as te,y as se,o as fe,q as $,r as H,p as Z,L as h,M as ce,u as A,ac as F,a0 as K}from"../../../chunks/singletons-ed5c0aef.js";import{m as D,g as W,p as ue,l as he}from"../../../chunks/firestore-bc135966.js";import{n as me}from"../../../chunks/navigation-515d5e98.js";import{g as pe}from"../../../chunks/navigation-b39ef914.js";function _e(a){let s;return{c(){s=d("div"),this.h()},l(o){s=w(o,"DIV",{class:!0});var n=v(s);n.forEach(p),this.h()},h(){b(s,"class","container")},m(o,n){j(o,s,n),s.innerHTML=a[0],a[2](s)},p(o,[n]){n&1&&(s.innerHTML=o[0])},i:Q,o:Q,d(o){o&&p(s),a[2](null)}}}function ge(a,s,o){let n,e;P(a,D,r=>o(3,n=r)),P(a,W,r=>o(4,e=r));let{html:t}=s,l;oe(()=>l.querySelectorAll(`a[href*="${S}"]`).forEach(r=>r.onclick=f));const f=r=>{var m;r.preventDefault(),r.stopPropagation();const i=(m=r.target)==null?void 0:m.href,u=i.substring(i.indexOf(S)+S.length+1);me(e,n,u)};function c(r){ne[r?"unshift":"push"](()=>{l=r,o(1,l)})}return a.$$set=r=>{"html"in r&&o(0,t=r.html)},[t,l,c]}class de extends q{constructor(s){super(),z(this,s,ge,_e,G,{html:0})}}const we=a=>({html:a&1,title:a&2}),R=a=>({html:a[0],title:a[1]});function ve(a){let s;const o=a[4].default,n=ae(o,a,a[3],R);return{c(){n&&n.c()},l(e){n&&n.l(e)},m(e,t){n&&n.m(e,t),s=!0},p(e,[t]){n&&n.p&&(!s||t&11)&&re(n,o,e,e[3],s?ie(o,e[3],t,we):le(e[3]),R)},i(e){s||(V(n,e),s=!0)},o(e){C(n,e),s=!1},d(e){n&&n.d(e)}}}const ke="https://en.wikipedia.org/w/api.php?origin=*&action=parse&format=json&page=",be="Error",Ee="Error, no wikipedia page found";function $e(a,s,o){let{$$slots:n={},$$scope:e}=s,{wiki:t=""}=s,l="\uC7A0\uC2DC\uB9CC\uC694~",f="Loading...";return a.$$set=c=>{"wiki"in c&&o(2,t=c.wiki),"$$scope"in c&&o(3,e=c.$$scope)},a.$$.update=()=>{a.$$.dirty&4&&fetch(`${ke}${t!=null?t:"Main_page"}`).then(c=>c.json()).then(c=>{var i,u,m,_;let r=(i=ue(c,JSON.stringify,JSON.parse))==null?void 0:i.parse;o(1,f=(u=r==null?void 0:r.title)!=null?u:be),o(0,l=(_=(m=r==null?void 0:r.text["*"])==null?void 0:m.replaceAll("/wiki/",`${S}/`))!=null?_:Ee)})},[l,f,t,e,n]}class He extends q{constructor(s){super(),z(this,s,$e,ve,G,{wiki:2})}}function X(a){let s,o,n,e,t=a[1]?"Won":"Lost",l,f,c,r,i,u=(a[1]?"You":a[2].who)+"",m,_,I,E,M,O,J;return{c(){s=d("div"),o=d("div"),n=d("p"),e=$("You "),l=$(t),f=$("!"),c=N(),r=d("p"),i=d("span"),m=$(u),_=$(`
				got to the end first!`),I=N(),E=d("button"),M=$("Go home"),this.h()},l(g){s=w(g,"DIV",{class:!0});var k=v(s);o=w(k,"DIV",{class:!0});var L=v(o);n=w(L,"P",{});var y=v(n);e=H(y,"You "),l=H(y,t),f=H(y,"!"),y.forEach(p),c=T(L),r=w(L,"P",{});var Y=v(r);i=w(Y,"SPAN",{style:!0});var U=v(i);m=H(U,u),U.forEach(p),_=H(Y,`
				got to the end first!`),Y.forEach(p),I=T(L),E=w(L,"BUTTON",{class:!0});var B=v(E);M=H(B,"Go home"),B.forEach(p),L.forEach(p),k.forEach(p),this.h()},h(){Z(i,"color",a[1]?"var(--text)":a[2].color),b(E,"class","button"),b(o,"class","card svelte-12z39j9"),b(s,"class","winner svelte-12z39j9")},m(g,k){j(g,s,k),h(s,o),h(o,n),h(n,e),h(n,l),h(n,f),h(o,c),h(o,r),h(r,i),h(i,m),h(r,_),h(o,I),h(o,E),h(E,M),O||(J=ce(E,"click",a[3]),O=!0)},p(g,k){k&2&&t!==(t=g[1]?"Won":"Lost")&&A(l,t),k&6&&u!==(u=(g[1]?"You":g[2].who)+"")&&A(m,u),k&6&&Z(i,"color",g[1]?"var(--text)":g[2].color)},d(g){g&&p(s),O=!1,J()}}}function Le(a){var r;let s,o,n,e=((r=a[7])!=null?r:"[error]: missing title")+"",t,l,f,c;return f=new de({props:{html:a[6]}}),{c(){s=d("section"),o=d("h1"),n=d("span"),t=$(e),l=N(),x(f.$$.fragment),this.h()},l(i){s=w(i,"SECTION",{class:!0});var u=v(s);o=w(u,"H1",{id:!0,class:!0});var m=v(o);n=w(m,"SPAN",{class:!0});var _=v(n);t=H(_,e),_.forEach(p),m.forEach(p),l=T(u),ee(f.$$.fragment,u),u.forEach(p),this.h()},h(){b(n,"class","mw-page-title-main"),b(o,"id","firstHeading"),b(o,"class","firstHeading mw-first-heading"),b(s,"class","svelte-12z39j9"),F(s,"end",a[1]||a[2].who!=="")},m(i,u){j(i,s,u),h(s,o),h(o,n),h(n,t),h(s,l),te(f,s,null),c=!0},p(i,u){var _;(!c||u&128)&&e!==(e=((_=i[7])!=null?_:"[error]: missing title")+"")&&A(t,e);const m={};u&64&&(m.html=i[6]),f.$set(m),(!c||u&6)&&F(s,"end",i[1]||i[2].who!=="")},i(i){c||(V(f.$$.fragment,i),c=!0)},o(i){C(f.$$.fragment,i),c=!1},d(i){i&&p(s),se(f)}}}function Pe(a){let s,o,n,e=(a[1]||a[2].who!=="")&&X(a);return o=new He({props:{wiki:a[0],$$slots:{default:[Le,({html:t,title:l})=>({6:t,7:l}),({html:t,title:l})=>(t?64:0)|(l?128:0)]},$$scope:{ctx:a}}}),{c(){e&&e.c(),s=N(),x(o.$$.fragment)},l(t){e&&e.l(t),s=T(t),ee(o.$$.fragment,t)},m(t,l){e&&e.m(t,l),j(t,s,l),te(o,t,l),n=!0},p(t,[l]){t[1]||t[2].who!==""?e?e.p(t,l):(e=X(t),e.c(),e.m(s.parentNode,s)):e&&(e.d(1),e=null);const f={};l&1&&(f.wiki=t[0]),l&454&&(f.$$scope={dirty:l,ctx:t}),o.$set(f)},i(t){n||(V(o.$$.fragment,t),n=!0)},o(t){C(o.$$.fragment,t),n=!1},d(t){e&&e.d(t),t&&p(s),se(o,t)}}}function Se(a,s,o){let n,e,t;P(a,D,r=>o(5,n=r)),P(a,W,r=>o(4,e=r)),P(a,he,r=>o(0,t=r));let l=!1,f={who:"",color:""};fe(()=>{if(n.uid===null||n.uid===""||n.gameId===""||t===""){c();return}});const c=()=>{K(W,e={id:"",state:"waiting",route:[],players:[]},e),K(D,n={...n,gameId:""},n),pe(S)};return a.$$.update=()=>{a.$$.dirty&17&&(t===e.route[e.route.length-1]?o(1,l=!0):e.players.forEach(r=>{r.progress.linkHistory[r.progress.linkHistory.length-1].url===e.route[e.route.length-1]&&o(2,f={who:r.name,color:r.color})}))},[t,l,f,c,e]}class Ie extends q{constructor(s){super(),z(this,s,Se,Pe,G,{})}}export{Ie as default};
