import{S as W,i as q,s as z,k as d,l as w,m as v,h as _,n as b,b as j,H as B,Q as P,j as se,a1 as S,ag as oe,W as ne,Y as ae,Z as re,_ as le,f as G,t as V,a as N,v as R,c as T,w as X,x,y as ee,o as ie,q as $,r as H,p as Q,L as h,M as ce,u as A,ac as Z,a0 as fe}from"../../../chunks/singletons-c6ca186c.js";import{m as te,g as D,p as ue,l as he}from"../../../chunks/firestore-5b84f65f.js";import{n as pe}from"../../../chunks/navigation-75a23848.js";import{g as _e}from"../../../chunks/navigation-101fe8c3.js";function me(a){let t;return{c(){t=d("div"),this.h()},l(s){t=w(s,"DIV",{class:!0});var o=v(t);o.forEach(_),this.h()},h(){b(t,"class","container")},m(s,o){j(s,t,o),t.innerHTML=a[0],a[2](t)},p(s,[o]){o&1&&(t.innerHTML=s[0])},i:B,o:B,d(s){s&&_(t),a[2](null)}}}function ge(a,t,s){let o,n;P(a,te,r=>s(3,o=r)),P(a,D,r=>s(4,n=r));let{html:e}=t,l;se(()=>l.querySelectorAll(`a[href*="${S}"]`).forEach(r=>r.onclick=c));const c=r=>{var p;r.preventDefault(),r.stopPropagation();const i=(p=r.target)==null?void 0:p.href,u=i.substring(i.indexOf(S)+S.length+1);pe(n,o,u)};function f(r){oe[r?"unshift":"push"](()=>{l=r,s(1,l)})}return a.$$set=r=>{"html"in r&&s(0,e=r.html)},[e,l,f]}class de extends W{constructor(t){super(),q(this,t,ge,me,z,{html:0})}}const we=a=>({html:a&1,title:a&2}),F=a=>({html:a[0],title:a[1]});function ve(a){let t;const s=a[4].default,o=ne(s,a,a[3],F);return{c(){o&&o.c()},l(n){o&&o.l(n)},m(n,e){o&&o.m(n,e),t=!0},p(n,[e]){o&&o.p&&(!t||e&11)&&ae(o,s,n,n[3],t?le(s,n[3],e,we):re(n[3]),F)},i(n){t||(G(o,n),t=!0)},o(n){V(o,n),t=!1},d(n){o&&o.d(n)}}}const ke="https://en.wikipedia.org/w/api.php?origin=*&action=parse&format=json&page=",be="Error",Ee="Error, no wikipedia page found";function $e(a,t,s){let{$$slots:o={},$$scope:n}=t,{wiki:e=""}=t,l="\uC7A0\uC2DC\uB9CC\uC694~",c="Loading...";return a.$$set=f=>{"wiki"in f&&s(2,e=f.wiki),"$$scope"in f&&s(3,n=f.$$scope)},a.$$.update=()=>{a.$$.dirty&4&&fetch(`${ke}${e!=null?e:"Main_page"}`).then(f=>f.json()).then(f=>{var i,u,p,m;let r=(i=ue(f,JSON.stringify,JSON.parse))==null?void 0:i.parse;s(1,c=(u=r==null?void 0:r.title)!=null?u:be),s(0,l=(m=(p=r==null?void 0:r.text["*"])==null?void 0:p.replaceAll("/wiki/",`${S}/`))!=null?m:Ee)})},[l,c,e,n,o]}class He extends W{constructor(t){super(),q(this,t,$e,ve,z,{wiki:2})}}function K(a){let t,s,o,n,e=a[1]?"Won":"Lost",l,c,f,r,i,u=(a[1]?"You":a[2].who)+"",p,m,M,E,I,O,C;return{c(){t=d("div"),s=d("div"),o=d("p"),n=$("You "),l=$(e),c=$("!"),f=N(),r=d("p"),i=d("span"),p=$(u),m=$(`
				got to the end first!`),M=N(),E=d("button"),I=$("Go home"),this.h()},l(g){t=w(g,"DIV",{class:!0});var k=v(t);s=w(k,"DIV",{class:!0});var L=v(s);o=w(L,"P",{});var y=v(o);n=H(y,"You "),l=H(y,e),c=H(y,"!"),y.forEach(_),f=T(L),r=w(L,"P",{});var Y=v(r);i=w(Y,"SPAN",{style:!0});var J=v(i);p=H(J,u),J.forEach(_),m=H(Y,`
				got to the end first!`),Y.forEach(_),M=T(L),E=w(L,"BUTTON",{class:!0});var U=v(E);I=H(U,"Go home"),U.forEach(_),L.forEach(_),k.forEach(_),this.h()},h(){Q(i,"color",a[1]?"var(--text)":a[2].color),b(E,"class","button"),b(s,"class","card svelte-12z39j9"),b(t,"class","winner svelte-12z39j9")},m(g,k){j(g,t,k),h(t,s),h(s,o),h(o,n),h(o,l),h(o,c),h(s,f),h(s,r),h(r,i),h(i,p),h(r,m),h(s,M),h(s,E),h(E,I),O||(C=ce(E,"click",a[3]),O=!0)},p(g,k){k&2&&e!==(e=g[1]?"Won":"Lost")&&A(l,e),k&6&&u!==(u=(g[1]?"You":g[2].who)+"")&&A(p,u),k&6&&Q(i,"color",g[1]?"var(--text)":g[2].color)},d(g){g&&_(t),O=!1,C()}}}function Le(a){var r;let t,s,o,n=((r=a[7])!=null?r:"[error]: missing title")+"",e,l,c,f;return c=new de({props:{html:a[6]}}),{c(){t=d("section"),s=d("h1"),o=d("span"),e=$(n),l=N(),R(c.$$.fragment),this.h()},l(i){t=w(i,"SECTION",{class:!0});var u=v(t);s=w(u,"H1",{id:!0,class:!0});var p=v(s);o=w(p,"SPAN",{class:!0});var m=v(o);e=H(m,n),m.forEach(_),p.forEach(_),l=T(u),X(c.$$.fragment,u),u.forEach(_),this.h()},h(){b(o,"class","mw-page-title-main"),b(s,"id","firstHeading"),b(s,"class","firstHeading mw-first-heading"),b(t,"class","svelte-12z39j9"),Z(t,"end",a[1]||a[2].who!=="")},m(i,u){j(i,t,u),h(t,s),h(s,o),h(o,e),h(t,l),x(c,t,null),f=!0},p(i,u){var m;(!f||u&128)&&n!==(n=((m=i[7])!=null?m:"[error]: missing title")+"")&&A(e,n);const p={};u&64&&(p.html=i[6]),c.$set(p),(!f||u&6)&&Z(t,"end",i[1]||i[2].who!=="")},i(i){f||(G(c.$$.fragment,i),f=!0)},o(i){V(c.$$.fragment,i),f=!1},d(i){i&&_(t),ee(c)}}}function Pe(a){let t,s,o,n=(a[1]||a[2].who!=="")&&K(a);return s=new He({props:{wiki:a[0],$$slots:{default:[Le,({html:e,title:l})=>({6:e,7:l}),({html:e,title:l})=>(e?64:0)|(l?128:0)]},$$scope:{ctx:a}}}),{c(){n&&n.c(),t=N(),R(s.$$.fragment)},l(e){n&&n.l(e),t=T(e),X(s.$$.fragment,e)},m(e,l){n&&n.m(e,l),j(e,t,l),x(s,e,l),o=!0},p(e,[l]){e[1]||e[2].who!==""?n?n.p(e,l):(n=K(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null);const c={};l&1&&(c.wiki=e[0]),l&454&&(c.$$scope={dirty:l,ctx:e}),s.$set(c)},i(e){o||(G(s.$$.fragment,e),o=!0)},o(e){V(s.$$.fragment,e),o=!1},d(e){n&&n.d(e),e&&_(t),ee(s,e)}}}function Se(a,t,s){let o,n,e;P(a,D,r=>s(4,o=r)),P(a,he,r=>s(0,n=r)),P(a,te,r=>s(5,e=r));let l=!1,c={who:"",color:""};ie(()=>{if(e.uid===null||e.uid===""||e.gameId===""||n===""){f();return}});const f=()=>{fe(D,o={id:"",state:"waiting",route:[],players:[]},o),console.log("won"),_e(S)};return a.$$.update=()=>{a.$$.dirty&17&&(n===o.route[o.route.length-1]?s(1,l=!0):o.players.forEach(r=>{r.progress.linkHistory[r.progress.linkHistory.length-1].url===o.route[o.route.length-1]&&s(2,c={who:r.name,color:r.color})}))},[n,l,c,f,o]}class Me extends W{constructor(t){super(),q(this,t,Se,Pe,z,{})}}export{Me as default};
