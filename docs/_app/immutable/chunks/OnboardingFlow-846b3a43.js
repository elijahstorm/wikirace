import{S as le,i as ne,s as re,k as E,q as j,a as B,l as D,m as S,r as W,h as c,c as A,n as w,ac as X,b as I,L as T,M as H,u as fe,H as J,ag as ve,ah as we,v as R,w as M,p as ge,x as q,g as oe,R as Ie,ae as Ee,d as ue,ai as De,f as V,t as N,y as L,aj as ce,Q as Y,a0 as Q,ad as He,N as ae,O as ie,ak as Pe,o as Te,a1 as Ge,P as de}from"./singletons-2be8b19c.js";import{m as Z,a as ze,b as ke,g as K,j as $e,c as xe,u as et}from"./firestore-483174af.js";import{I as be}from"./BackButton-ba7f99ad.js";import{d as Je}from"./navigation-7beacb47.js";import{a as Ye,r as Qe,f as x}from"./storage-6ae130ee.js";import{p as tt}from"./stores-2ce921a9.js";import{R as Xe,P as Ke}from"./RouteViewer-d3069709.js";import{a as lt}from"./Toasts.svelte_svelte_type_style_lang-b9c4ca26.js";import{C as nt,F as rt}from"./FallbackImage-3b330508.js";function Ne(i){let e;return{c(){e=E("div"),this.h()},l(t){e=D(t,"DIV",{class:!0,style:!0}),S(e).forEach(c),this.h()},h(){w(e,"class","input-icon icon-username svelte-1a22rmd"),w(e,"style",i[7])},m(t,l){I(t,e,l)},p(t,l){l&128&&w(e,"style",t[7])},d(t){t&&c(e)}}}function at(i){let e,t,l,n,s,r,a,o,d=i[4]!=""&&Ne(i);return{c(){e=E("div"),t=E("label"),l=j(i[0]),n=B(),d&&d.c(),s=B(),r=E("input"),this.h()},l(f){e=D(f,"DIV",{class:!0});var _=S(e);t=D(_,"LABEL",{for:!0,class:!0});var v=S(t);l=W(v,i[0]),v.forEach(c),n=A(_),d&&d.l(_),s=A(_),r=D(_,"INPUT",{id:!0,name:!0,placeholder:!0,type:!0,class:!0}),_.forEach(c),this.h()},h(){w(t,"for",i[1]),w(t,"class","svelte-1a22rmd"),w(r,"id",i[2]),w(r,"name",i[1]),w(r,"placeholder",i[0]),w(r,"type",i[3]),r.required=i[5],w(r,"class","svelte-1a22rmd"),X(r,"push",i[4]!=""),X(r,"attempted",i[6]),w(e,"class","input-container svelte-1a22rmd")},m(f,_){I(f,e,_),T(e,t),T(t,l),T(e,n),d&&d.m(e,null),T(e,s),T(e,r),a||(o=H(r,"input",i[8]),a=!0)},p(f,[_]){_&1&&fe(l,f[0]),_&2&&w(t,"for",f[1]),f[4]!=""?d?d.p(f,_):(d=Ne(f),d.c(),d.m(e,s)):d&&(d.d(1),d=null),_&4&&w(r,"id",f[2]),_&2&&w(r,"name",f[1]),_&1&&w(r,"placeholder",f[0]),_&8&&w(r,"type",f[3]),_&32&&(r.required=f[5]),_&16&&X(r,"push",f[4]!=""),_&64&&X(r,"attempted",f[6])},i:J,o:J,d(f){f&&c(e),d&&d.d(),a=!1,o()}}}function it(i,e,t){let l,{text:n}=e,{name:s}=e,{id:r}=e,{type:a}=e,{icon:o=""}=e,{required:d=!1}=e,{attempted:f=!1}=e,{value:_=""}=e;const v=p=>{var h,m;t(9,_=(m=(h=p.target)==null?void 0:h.value)!=null?m:"")};return i.$$set=p=>{"text"in p&&t(0,n=p.text),"name"in p&&t(1,s=p.name),"id"in p&&t(2,r=p.id),"type"in p&&t(3,a=p.type),"icon"in p&&t(4,o=p.icon),"required"in p&&t(5,d=p.required),"attempted"in p&&t(6,f=p.attempted),"value"in p&&t(9,_=p.value)},i.$$.update=()=>{i.$$.dirty&16&&t(7,l=`background: url(${o}); background-size: 1.5rem auto; background-repeat: repeat;`)},[n,s,r,a,o,d,f,l,v,_]}class Se extends le{constructor(e){super(),ne(this,e,it,at,re,{text:0,name:1,id:2,type:3,icon:4,required:5,attempted:6,value:9})}}function Oe(i,e,t){const l=i.slice();return l[11]=e[t],l}function Be(i){let e,t;return e=new be({props:{icon:"akar-icons:check",color:"var(--bg)"}}),{c(){R(e.$$.fragment)},l(l){M(e.$$.fragment,l)},m(l,n){q(e,l,n),t=!0},i(l){t||(V(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){L(e,l)}}}function Ae(i,e){let t,l,n,s,r,a=e[11]===e[2]&&Be();function o(){return e[6](e[11])}function d(){return e[7](e[11])}return{key:i,first:null,c(){t=E("div"),a&&a.c(),l=B(),this.h()},l(f){t=D(f,"DIV",{class:!0,style:!0});var _=S(t);a&&a.l(_),l=A(_),_.forEach(c),this.h()},h(){w(t,"class","color svelte-wrl5lk"),w(t,"style",`background: ${e[11]};`),this.first=t},m(f,_){I(f,t,_),a&&a.m(t,null),T(t,l),n=!0,s||(r=[H(t,"click",o),H(t,"keydown",d)],s=!0)},p(f,_){e=f,e[11]===e[2]?a?_&4&&V(a,1):(a=Be(),a.c(),V(a,1),a.m(t,l)):a&&(oe(),N(a,1,1,()=>{a=null}),ue())},i(f){n||(V(a),n=!0)},o(f){N(a),n=!1},d(f){f&&c(t),a&&a.d(),s=!1,ce(r)}}}function st(i){let e,t,l,n,s,r,a=[],o=new Map,d,f,_,v,p,h,m,y,C,O=i[3];const P=u=>u[11];for(let u=0;u<O.length;u+=1){let b=Oe(i,O,u),F=P(b);o.set(F,a[u]=Ae(F,b))}function g(u){i[8](u)}let $={text:"Or choose a name",name:"name",id:"name",type:"name"};return i[0]!==void 0&&($.value=i[0]),f=new Se({props:$}),ve.push(()=>we(f,"value",g)),{c(){e=E("p"),t=j(`Your name is:
	`),l=E("span"),n=j(i[1]),s=B(),r=E("div");for(let u=0;u<a.length;u+=1)a[u].c();d=B(),R(f.$$.fragment),v=B(),p=E("button"),h=j("Save name"),this.h()},l(u){e=D(u,"P",{});var b=S(e);t=W(b,`Your name is:
	`),l=D(b,"SPAN",{style:!0});var F=S(l);n=W(F,i[1]),F.forEach(c),b.forEach(c),s=A(u),r=D(u,"DIV",{class:!0});var ee=S(r);for(let he=0;he<a.length;he+=1)a[he].l(ee);ee.forEach(c),d=A(u),M(f.$$.fragment,u),v=A(u),p=D(u,"BUTTON",{class:!0});var me=S(p);h=W(me,"Save name"),me.forEach(c),this.h()},h(){ge(l,"color",i[2]),w(r,"class","flex svelte-wrl5lk"),w(p,"class","button svelte-wrl5lk"),X(p,"disabled",!i[1]||i[1]==="")},m(u,b){I(u,e,b),T(e,t),T(e,l),T(l,n),I(u,s,b),I(u,r,b);for(let F=0;F<a.length;F+=1)a[F].m(r,null);I(u,d,b),q(f,u,b),I(u,v,b),I(u,p,b),T(p,h),m=!0,y||(C=[H(p,"click",i[5]),H(p,"keydown",i[5])],y=!0)},p(u,[b]){(!m||b&2)&&fe(n,u[1]),(!m||b&4)&&ge(l,"color",u[2]),b&28&&(O=u[3],oe(),a=Ie(a,b,P,1,u,O,o,r,Ee,Ae,null,Oe),ue());const F={};!_&&b&1&&(_=!0,F.value=u[0],De(()=>_=!1)),f.$set(F),(!m||b&2)&&X(p,"disabled",!u[1]||u[1]==="")},i(u){if(!m){for(let b=0;b<O.length;b+=1)V(a[b]);V(f.$$.fragment,u),m=!0}},o(u){for(let b=0;b<a.length;b+=1)N(a[b]);N(f.$$.fragment,u),m=!1},d(u){u&&c(e),u&&c(s),u&&c(r);for(let b=0;b<a.length;b+=1)a[b].d();u&&c(d),L(f,u),u&&c(v),u&&c(p),y=!1,ce(C)}}}function ot(i,e,t){let l;Y(i,Z,h=>t(9,l=h));const n=["party_animal","happy_go_lucky","fun_loving","carefree","lighthearted","whimsical","playful","mischievous","impish","jolly","Goofy","Dopey","Grumpy","Bashful","Sleepy","Happy","Sneezy","Doc","Snow White","Cinderella","Sleeping Beauty","Little Red Riding Hood","The Three Little Pigs","The Big Bad Wolf","Goldilocks","The Three Bears","Rapunzel","Hansel and Gretel","Rumpelstiltskin","Jack and the Beanstalk","cutiepie","sugar","cupcake","cutesy","darling","precious","lovebug","sweetie","sugarplum","angel"],s=["#ffda1e","#f2a005","#f24503","#fe9ad2","#9d9bfe","#1f99fd","#7ac6ff","#60dfcd","#62ca9c"];let r=n[Math.floor(Math.random()*n.length)],a=s[Math.floor(Math.random()*s.length)],o="";const d=h=>{t(2,a=h)},f=()=>{!r||r===""||(Q(Z,l={name:r.trim(),uid:"",gameId:"",color:a,score:0},l),ze({type:"player",content:l}).then(h=>{var m;Q(Z,l={...l,uid:(m=h==null?void 0:h.id)!=null?m:""},l),ke({type:"player",id:l.uid,content:l})}))},_=h=>d(h),v=h=>d(h);function p(h){o=h,t(0,o)}return i.$$.update=()=>{i.$$.dirty&1&&t(1,r=o===""?n[Math.floor(Math.random()*n.length)]:o)},[o,r,a,s,d,f,_,v,p]}class ut extends le{constructor(e){super(),ne(this,e,ot,st,re,{})}}function Re(i,e,t){const l=i.slice();return l[19]=e[t],l[21]=t,l}function Me(i,e,t){const l=i.slice();return l[22]=e[t],l[21]=t,l}function ft(i){let e,t,l=i[6].route,n=[];for(let r=0;r<l.length;r+=1)n[r]=qe(Me(i,l,r));const s=r=>N(n[r],1,1,()=>{n[r]=null});return{c(){e=E("div");for(let r=0;r<n.length;r+=1)n[r].c();this.h()},l(r){e=D(r,"DIV",{class:!0});var a=S(e);for(let o=0;o<n.length;o+=1)n[o].l(a);a.forEach(c),this.h()},h(){w(e,"class","numbered-list svelte-vfirp4")},m(r,a){I(r,e,a);for(let o=0;o<n.length;o+=1)n[o].m(e,null);t=!0},p(r,a){if(a&576){l=r[6].route;let o;for(o=0;o<l.length;o+=1){const d=Me(r,l,o);n[o]?(n[o].p(d,a),V(n[o],1)):(n[o]=qe(d),n[o].c(),V(n[o],1),n[o].m(e,null))}for(oe(),o=l.length;o<n.length;o+=1)s(o);ue()}},i(r){if(!t){for(let a=0;a<l.length;a+=1)V(n[a]);t=!0}},o(r){n=n.filter(Boolean);for(let a=0;a<n.length;a+=1)N(n[a]);t=!1},d(r){r&&c(e),He(n,r)}}}function ct(i){let e,t,l,n,s,r,a,o,d,f,_,v;function p(m){i[12](m)}let h={text:"Join an existing game",name:"gameId",id:"gameId",type:"gameId"};return i[1]!==void 0&&(h.value=i[1]),t=new Se({props:h}),ve.push(()=>we(t,"value",p)),r=new be({props:{icon:"akar-icons:send",width:25}}),{c(){e=E("div"),R(t.$$.fragment),n=B(),s=E("button"),R(r.$$.fragment),a=B(),o=E("p"),d=j("Or..."),this.h()},l(m){e=D(m,"DIV",{class:!0});var y=S(e);M(t.$$.fragment,y),n=A(y),s=D(y,"BUTTON",{class:!0});var C=S(s);M(r.$$.fragment,C),C.forEach(c),y.forEach(c),a=A(m),o=D(m,"P",{});var O=S(o);d=W(O,"Or..."),O.forEach(c),this.h()},h(){w(s,"class","button svelte-vfirp4"),w(e,"class","flex svelte-vfirp4"),X(e,"shake",i[3])},m(m,y){I(m,e,y),q(t,e,null),T(e,n),T(e,s),q(r,s,null),I(m,a,y),I(m,o,y),T(o,d),f=!0,_||(v=H(s,"click",i[7]),_=!0)},p(m,y){const C={};!l&&y&2&&(l=!0,C.value=m[1],De(()=>l=!1)),t.$set(C),(!f||y&8)&&X(e,"shake",m[3])},i(m){f||(V(t.$$.fragment,m),V(r.$$.fragment,m),f=!0)},o(m){N(t.$$.fragment,m),N(r.$$.fragment,m),f=!1},d(m){m&&c(e),L(t),L(r),m&&c(a),m&&c(o),_=!1,v()}}}function qe(i){let e,t,l=i[21]+1+"",n,s,r=i[22].replaceAll("_"," ")+"",a,o,d,f,_,v,p,h,m;return f=new be({props:{color:"red",icon:"akar-icons:cross"}}),{c(){e=E("div"),t=E("span"),n=j(l),s=j(". "),a=j(r),o=B(),d=E("div"),R(f.$$.fragment),_=B(),this.h()},l(y){e=D(y,"DIV",{class:!0});var C=S(e);t=D(C,"SPAN",{});var O=S(t);n=W(O,l),s=W(O,". "),a=W(O,r),O.forEach(c),o=A(C),d=D(C,"DIV",{style:!0});var P=S(d);M(f.$$.fragment,P),P.forEach(c),_=A(C),C.forEach(c),this.h()},h(){ge(d,"cursor","pointer"),w(e,"class","svelte-vfirp4")},m(y,C){I(y,e,C),T(e,t),T(t,n),T(t,s),T(t,a),T(e,o),T(e,d),q(f,d,null),T(e,_),p=!0,h||(m=H(d,"click",i[9](i[21])),h=!0)},p(y,C){i=y,(!p||C&64)&&r!==(r=i[22].replaceAll("_"," ")+"")&&fe(a,r)},i(y){p||(V(f.$$.fragment,y),v||ae(()=>{v=ie(e,Ye,{}),v.start()}),p=!0)},o(y){N(f.$$.fragment,y),p=!1},d(y){y&&c(e),L(f),h=!1,m()}}}function Le(i){let e,t=i[19].title+"",l,n,s,r,a;return{c(){e=E("div"),l=j(t),n=B(),this.h()},l(o){e=D(o,"DIV",{class:!0});var d=S(e);l=W(d,t),n=A(d),d.forEach(c),this.h()},h(){w(e,"class","svelte-vfirp4")},m(o,d){I(o,e,d),T(e,l),T(e,n),r||(a=[H(e,"click",i[8](i[21])),H(e,"keydown",i[8](i[21]))],r=!0)},p(o,d){i=o,d&16&&t!==(t=i[19].title+"")&&fe(l,t)},i(o){s||ae(()=>{s=ie(e,Ye,{}),s.start()})},o:J,d(o){o&&c(e),r=!1,ce(a)}}}function dt(i){let e,t,l,n=i[5].name+"",s,r,a,o,d,f,_,v,p,h,m,y,C,O,P,g,$,u,b;const F=[ct,ft],ee=[];function me(k,G){return k[6].route.length===0?0:1}f=me(i),_=ee[f]=F[f](i);function he(k){i[13](k)}let Ce={text:"Choose the next route",name:"route",id:"route",type:"route"};i[0]!==void 0&&(Ce.value=i[0]),h=new Se({props:Ce}),ve.push(()=>we(h,"value",he));let se=i[4],U=[];for(let k=0;k<se.length;k+=1)U[k]=Le(Re(i,se,k));return{c(){e=E("p"),t=j("Welcome "),l=E("span"),s=j(n),r=j(`.
	`),a=E("span"),o=j("Change name?"),d=B(),_.c(),v=B(),p=E("div"),R(h.$$.fragment),y=B(),C=E("div");for(let k=0;k<U.length;k+=1)U[k].c();O=B(),P=E("button"),g=j("Finish Selection"),this.h()},l(k){e=D(k,"P",{});var G=S(e);t=W(G,"Welcome "),l=D(G,"SPAN",{style:!0});var te=S(l);s=W(te,n),te.forEach(c),r=W(G,`.
	`),a=D(G,"SPAN",{class:!0});var _e=S(a);o=W(_e,"Change name?"),_e.forEach(c),G.forEach(c),d=A(k),_.l(k),v=A(k),p=D(k,"DIV",{class:!0});var z=S(p);M(h.$$.fragment,z),z.forEach(c),y=A(k),C=D(k,"DIV",{class:!0});var pe=S(C);for(let ye=0;ye<U.length;ye+=1)U[ye].l(pe);pe.forEach(c),O=A(k),P=D(k,"BUTTON",{class:!0});var Ve=S(P);g=W(Ve,"Finish Selection"),Ve.forEach(c),this.h()},h(){ge(l,"color",i[5].color),w(a,"class","link svelte-vfirp4"),w(p,"class","svelte-vfirp4"),X(p,"shake",i[2]),w(C,"class","search-results svelte-vfirp4"),X(C,"hidden",i[4].length===0),w(P,"class","button svelte-vfirp4"),X(P,"disabled",i[6].route.length<2)},m(k,G){I(k,e,G),T(e,t),T(e,l),T(l,s),T(e,r),T(e,a),T(a,o),I(k,d,G),ee[f].m(k,G),I(k,v,G),I(k,p,G),q(h,p,null),I(k,y,G),I(k,C,G);for(let te=0;te<U.length;te+=1)U[te].m(C,null);I(k,O,G),I(k,P,G),T(P,g),$=!0,u||(b=[H(a,"click",i[11]),H(P,"click",i[10]),H(P,"keydown",i[10])],u=!0)},p(k,[G]){(!$||G&32)&&n!==(n=k[5].name+"")&&fe(s,n),(!$||G&32)&&ge(l,"color",k[5].color);let te=f;f=me(k),f===te?ee[f].p(k,G):(oe(),N(ee[te],1,1,()=>{ee[te]=null}),ue(),_=ee[f],_?_.p(k,G):(_=ee[f]=F[f](k),_.c()),V(_,1),_.m(v.parentNode,v));const _e={};if(!m&&G&1&&(m=!0,_e.value=k[0],De(()=>m=!1)),h.$set(_e),(!$||G&4)&&X(p,"shake",k[2]),G&272){se=k[4];let z;for(z=0;z<se.length;z+=1){const pe=Re(k,se,z);U[z]?(U[z].p(pe,G),V(U[z],1)):(U[z]=Le(pe),U[z].c(),V(U[z],1),U[z].m(C,null))}for(;z<U.length;z+=1)U[z].d(1);U.length=se.length}(!$||G&16)&&X(C,"hidden",k[4].length===0),(!$||G&64)&&X(P,"disabled",k[6].route.length<2)},i(k){if(!$){V(_),V(h.$$.fragment,k);for(let G=0;G<se.length;G+=1)V(U[G]);$=!0}},o(k){N(_),N(h.$$.fragment,k),$=!1},d(k){k&&c(e),k&&c(d),ee[f].d(k),k&&c(v),k&&c(p),L(h),k&&c(y),k&&c(C),He(U,k),k&&c(O),k&&c(P),u=!1,ce(b)}}}function mt(i,e,t){let l,n,s;Y(i,Z,u=>t(5,l=u)),Y(i,K,u=>t(6,n=u)),Y(i,$e,u=>t(15,s=u));let r,a,o=!1,d=!1,f=[],_;const v=(u,b)=>{clearTimeout(_),_=setTimeout(()=>{u()},b)},p=async()=>{t(2,o=!0),await new Promise(u=>setTimeout(u,820)),t(2,o=!1)},h=async()=>{t(3,d=!0),await new Promise(u=>setTimeout(u,820)),t(3,d=!1)},m=async()=>{await(await xe({type:"game",id:a})).exists?Q($e,s=a,s):h()},y=u=>()=>{const b=f[u].title;if(!b||b===""){p();return}if(n.route.includes(b)){p();return}Q(K,n={...n,route:[...n.route,b]},n),t(4,f=[])},C=u=>()=>{n.route.splice(u,1),Q(K,n={...n,route:[...n.route]},n)},O=()=>{n.route.length<2||(Q(K,n={...n,route:n.route.map(u=>u.replaceAll(" ","_")),id:"",state:"waiting",players:[{...l,progress:Je}]},n),ze({type:"game",content:n}).then(u=>{var F;const b=(F=u==null?void 0:u.id)!=null?F:"";Q(K,n={...n,id:b},n),Q(Z,l={...l,gameId:b},l),ke({type:"player",id:l.uid,content:l})}))},P=()=>{Qe(),Q(Z,l={...l,uid:""},l)};function g(u){a=u,t(1,a)}function $(u){r=u,t(0,r)}return i.$$.update=()=>{i.$$.dirty&1&&(t(4,f=[]),v(()=>!r||r===""?null:fetch(`https://en.wikipedia.org/w/api.php?&origin=*&action=query&format=json&list=search&srsearch=${r.trim()}`).then(u=>u.json()).then(u=>{var b;return t(4,f=(b=u==null?void 0:u.query)==null?void 0:b.search)}),500))},[r,a,o,d,f,l,n,m,y,C,O,P,g,$]}class ht extends le{constructor(e){super(),ne(this,e,mt,dt,re,{})}}function _t(i){let e,t,l;return{c(){e=E("textarea"),this.h()},l(n){e=D(n,"TEXTAREA",{class:!0}),S(e).forEach(c),this.h()},h(){w(e,"class","svelte-zw49ni")},m(n,s){I(n,e,s),Pe(e,i[0]),i[3](e),t||(l=H(e,"input",i[2]),t=!0)},p(n,[s]){s&1&&Pe(e,n[0])},i:J,o:J,d(n){n&&c(e),i[3](null),t=!1,l()}}}function pt(i,e,t){let{value:l}=e,n;Te(()=>{n.select(),n.setSelectionRange(0,99999),navigator.clipboard.writeText(n.value)});function s(){l=this.value,t(0,l)}function r(a){ve[a?"unshift":"push"](()=>{n=a,t(1,n)})}return i.$$set=a=>{"value"in a&&t(0,l=a.value)},[l,n,s,r]}class gt extends le{constructor(e){super(),ne(this,e,pt,_t,re,{value:0})}}function vt(i){let e,t,l,n,s,r;return{c(){e=E("button"),t=j("Click here to copy Game ID"),l=B(),n=E("div"),this.h()},l(a){e=D(a,"BUTTON",{class:!0});var o=S(e);t=W(o,"Click here to copy Game ID"),o.forEach(c),l=A(a),n=D(a,"DIV",{}),S(n).forEach(c),this.h()},h(){w(e,"class","button")},m(a,o){I(a,e,o),T(e,t),I(a,l,o),I(a,n,o),i[3](n),s||(r=[H(e,"click",i[1]),H(e,"keydown",i[1])],s=!0)},p:J,i:J,o:J,d(a){a&&c(e),a&&c(l),a&&c(n),i[3](null),s=!1,ce(r)}}}function kt(i,e,t){let l;Y(i,K,o=>t(2,l=o));let n,s;const r=()=>{const o=s;new gt({target:n,props:{value:o}}).$destroy(),lt("Game ID copied!")};function a(o){ve[o?"unshift":"push"](()=>{n=o,t(0,n)})}return i.$$.update=()=>{i.$$.dirty&4&&(s=`${l.id}`)},[n,r,l,a]}class Ze extends le{constructor(e){super(),ne(this,e,kt,vt,re,{})}}function Ue(i,e,t){const l=i.slice();return l[6]=e[t],l}function je(i,e){let t,l,n,s,r;return l=new Ke({props:{player:e[6]}}),{key:i,first:null,c(){t=E("div"),R(l.$$.fragment),this.h()},l(a){t=D(a,"DIV",{});var o=S(t);M(l.$$.fragment,o),o.forEach(c),this.h()},h(){this.first=t},m(a,o){I(a,t,o),q(l,t,null),r=!0},p(a,o){e=a;const d={};o&1&&(d.player=e[6]),l.$set(d)},i(a){r||(V(l.$$.fragment,a),ae(()=>{s&&s.end(1),n=ie(t,x,{y:20}),n.start()}),r=!0)},o(a){N(l.$$.fragment,a),n&&n.invalidate(),s=de(t,x,{x:100}),r=!1},d(a){a&&c(t),L(l),a&&s&&s.end()}}}function bt(i){let e,t,l,n;return{c(){e=E("button"),t=j("Start Game"),this.h()},l(s){e=D(s,"BUTTON",{class:!0});var r=S(e);t=W(r,"Start Game"),r.forEach(c),this.h()},h(){w(e,"class","button")},m(s,r){I(s,e,r),T(e,t),l||(n=[H(e,"click",i[1]),H(e,"keydown",i[1])],l=!0)},p:J,d(s){s&&c(e),l=!1,ce(n)}}}function yt(i){let e,t;return{c(){e=E("p"),t=j("Cannot start game with only one player :)"),this.h()},l(l){e=D(l,"P",{class:!0});var n=S(e);t=W(n,"Cannot start game with only one player :)"),n.forEach(c),this.h()},h(){w(e,"class","svelte-1i4hkn9")},m(l,n){I(l,e,n),T(e,t)},p:J,d(l){l&&c(e)}}}function $t(i){let e,t,l,n,s,r,a=[],o=new Map,d,f,_,v,p,h;l=new be({props:{icon:"fluent:arrow-reset-24-filled",width:25}}),s=new Xe({props:{route:i[0].route}});let m=i[0].players;const y=g=>g[6].uid;for(let g=0;g<m.length;g+=1){let $=Ue(i,m,g),u=y($);o.set(u,a[g]=je(u,$))}function C(g,$){return g[0].players.length===1?yt:bt}let O=C(i),P=O(i);return _=new Ze({}),{c(){e=E("div"),t=E("button"),R(l.$$.fragment),n=B(),R(s.$$.fragment),r=B();for(let g=0;g<a.length;g+=1)a[g].c();d=B(),P.c(),f=B(),R(_.$$.fragment),this.h()},l(g){e=D(g,"DIV",{class:!0});var $=S(e);t=D($,"BUTTON",{class:!0});var u=S(t);M(l.$$.fragment,u),u.forEach(c),$.forEach(c),n=A(g),M(s.$$.fragment,g),r=A(g);for(let b=0;b<a.length;b+=1)a[b].l(g);d=A(g),P.l(g),f=A(g),M(_.$$.fragment,g),this.h()},h(){w(t,"class","button back-btn svelte-1i4hkn9"),w(e,"class","flex")},m(g,$){I(g,e,$),T(e,t),q(l,t,null),I(g,n,$),q(s,g,$),I(g,r,$);for(let u=0;u<a.length;u+=1)a[u].m(g,$);I(g,d,$),P.m(g,$),I(g,f,$),q(_,g,$),v=!0,p||(h=H(t,"click",i[2]),p=!0)},p(g,[$]){const u={};$&1&&(u.route=g[0].route),s.$set(u),$&1&&(m=g[0].players,oe(),a=Ie(a,$,y,1,g,m,o,d.parentNode,Ee,je,d,Ue),ue()),O===(O=C(g))&&P?P.p(g,$):(P.d(1),P=O(g),P&&(P.c(),P.m(f.parentNode,f)))},i(g){if(!v){V(l.$$.fragment,g),V(s.$$.fragment,g);for(let $=0;$<m.length;$+=1)V(a[$]);V(_.$$.fragment,g),v=!0}},o(g){N(l.$$.fragment,g),N(s.$$.fragment,g);for(let $=0;$<a.length;$+=1)N(a[$]);N(_.$$.fragment,g),v=!1},d(g){g&&c(e),L(l),g&&c(n),L(s,g),g&&c(r);for(let $=0;$<a.length;$+=1)a[$].d(g);g&&c(d),P.d(g),g&&c(f),L(_,g),p=!1,h()}}}function wt(i,e,t){let l,n,s;Y(i,K,o=>t(0,l=o)),Y(i,Z,o=>t(5,n=o)),Y(i,tt,o=>t(3,s=o));const r=()=>{Q(K,l={...l,state:"countdown"},l),ke({type:"game",id:l.id,content:l})},a=()=>{Qe(),Q(Z,n={...n,gameId:""},n),Q(K,l={...l,id:""},l)};return i.$$.update=()=>{i.$$.dirty&9&&`${s.url.toString().split(Ge)[0]}${Ge}${l.id}`},[l,r,a,s]}class It extends le{constructor(e){super(),ne(this,e,wt,$t,re,{})}}function Et(i){let e,t=(i[0]<=0?"GO!":i[0])+"",l;return{c(){e=E("section"),l=j(t),this.h()},l(n){e=D(n,"SECTION",{class:!0});var s=S(e);l=W(s,t),s.forEach(c),this.h()},h(){w(e,"class","svelte-y04exd")},m(n,s){I(n,e,s),T(e,l)},p(n,[s]){s&1&&t!==(t=(n[0]<=0?"GO!":n[0])+"")&&fe(l,t)},i:J,o:J,d(n){n&&c(e)}}}function Dt(i,e,t){let l,n;Y(i,K,a=>t(1,l=a)),Y(i,Z,a=>t(2,n=a));let s=5;Te(()=>{r()});const r=async()=>{if(s<0){const a=l.players,o=a.findIndex(d=>n.uid===d.uid);if(o===-1){console.error("cannot find your user");return}a[o].progress={linksProgressed:0,backNavs:0,isCriticallyClose:!1,timesCriticallyClose:0,linkHistory:[{type:"url",url:l.route[0],index:0}]},Q(K,l={...l,state:"started",players:a},l),ke({type:"game",id:l.id,content:l});return}await new Promise(a=>setTimeout(a,1e3)),t(0,s--,s),r()};return[s]}class Tt extends le{constructor(e){super(),ne(this,e,Dt,Et,re,{})}}function We(i,e,t){const l=i.slice();return l[3]=e[t],l}function Fe(i,e){let t,l,n;return l=new Ke({props:{player:e[3]}}),{key:i,first:null,c(){t=E("div"),R(l.$$.fragment),this.h()},l(s){t=D(s,"DIV",{});var r=S(t);M(l.$$.fragment,r),r.forEach(c),this.h()},h(){this.first=t},m(s,r){I(s,t,r),q(l,t,null),n=!0},p(s,r){e=s;const a={};r&1&&(a.player=e[3]),l.$set(a)},i(s){n||(V(l.$$.fragment,s),n=!0)},o(s){N(l.$$.fragment,s),n=!1},d(s){s&&c(t),L(l)}}}function St(i){let e,t,l,n=[],s=new Map,r,a,o,d,f,_;t=new Xe({props:{route:i[0].route}});let v=i[0].players;const p=h=>h[3].uid;for(let h=0;h<v.length;h+=1){let m=We(i,v,h),y=p(m);s.set(y,n[h]=Fe(y,m))}return a=new Ze({}),{c(){e=E("section"),R(t.$$.fragment),l=B();for(let h=0;h<n.length;h+=1)n[h].c();r=B(),R(a.$$.fragment),o=B(),d=E("p"),f=j("Waiting for host to start game"),this.h()},l(h){e=D(h,"SECTION",{class:!0});var m=S(e);M(t.$$.fragment,m),l=A(m);for(let C=0;C<n.length;C+=1)n[C].l(m);r=A(m),M(a.$$.fragment,m),o=A(m),d=D(m,"P",{});var y=S(d);f=W(y,"Waiting for host to start game"),y.forEach(c),m.forEach(c),this.h()},h(){w(e,"class","svelte-2bcj0m")},m(h,m){I(h,e,m),q(t,e,null),T(e,l);for(let y=0;y<n.length;y+=1)n[y].m(e,null);T(e,r),q(a,e,null),T(e,o),T(e,d),T(d,f),_=!0},p(h,[m]){const y={};m&1&&(y.route=h[0].route),t.$set(y),m&1&&(v=h[0].players,oe(),n=Ie(n,m,p,1,h,v,s,e,Ee,Fe,r,We),ue())},i(h){if(!_){V(t.$$.fragment,h);for(let m=0;m<v.length;m+=1)V(n[m]);V(a.$$.fragment,h),_=!0}},o(h){N(t.$$.fragment,h);for(let m=0;m<n.length;m+=1)N(n[m]);N(a.$$.fragment,h),_=!1},d(h){h&&c(e),L(t);for(let m=0;m<n.length;m+=1)n[m].d();L(a)}}}function Ct(i,e,t){let l,n;Y(i,Z,r=>t(2,l=r)),Y(i,K,r=>t(0,n=r));let{gameId:s}=e;return Te(()=>{l.gameId!==s&&l.uid&&l.uid!==""&&(Q(Z,l={...l,gameId:s},l),et({type:"game",id:s},"players",{...l,progress:Je}))}),i.$$set=r=>{"gameId"in r&&t(1,s=r.gameId)},[n,s]}class Vt extends le{constructor(e){super(),ne(this,e,Ct,St,re,{gameId:1})}}function Pt(i){let e,t,l,n,s;return t=new Tt({}),{c(){e=E("div"),R(t.$$.fragment),this.h()},l(r){e=D(r,"DIV",{class:!0});var a=S(e);M(t.$$.fragment,a),a.forEach(c),this.h()},h(){w(e,"class","maintain-position svelte-19t4g5g")},m(r,a){I(r,e,a),q(t,e,null),s=!0},p:J,i(r){s||(V(t.$$.fragment,r),ae(()=>{n&&n.end(1),l=ie(e,x,{x:500}),l.start()}),s=!0)},o(r){N(t.$$.fragment,r),l&&l.invalidate(),n=de(e,x,{x:-500}),s=!1},d(r){r&&c(e),L(t),r&&n&&n.end()}}}function Gt(i){let e,t,l,n,s;return t=new It({}),{c(){e=E("div"),R(t.$$.fragment),this.h()},l(r){e=D(r,"DIV",{class:!0});var a=S(e);M(t.$$.fragment,a),a.forEach(c),this.h()},h(){w(e,"class","maintain-position svelte-19t4g5g")},m(r,a){I(r,e,a),q(t,e,null),s=!0},p:J,i(r){s||(V(t.$$.fragment,r),ae(()=>{n&&n.end(1),l=ie(e,x,{x:500}),l.start()}),s=!0)},o(r){N(t.$$.fragment,r),l&&l.invalidate(),n=de(e,x,{x:-500}),s=!1},d(r){r&&c(e),L(t),r&&n&&n.end()}}}function Nt(i){let e,t,l,n,s;return t=new ht({}),{c(){e=E("div"),R(t.$$.fragment),this.h()},l(r){e=D(r,"DIV",{class:!0});var a=S(e);M(t.$$.fragment,a),a.forEach(c),this.h()},h(){w(e,"class","maintain-position svelte-19t4g5g")},m(r,a){I(r,e,a),q(t,e,null),s=!0},p:J,i(r){s||(V(t.$$.fragment,r),ae(()=>{n&&n.end(1),l=ie(e,x,{x:500}),l.start()}),s=!0)},o(r){N(t.$$.fragment,r),l&&l.invalidate(),n=de(e,x,{x:-500}),s=!1},d(r){r&&c(e),L(t),r&&n&&n.end()}}}function Ot(i){let e,t,l,n,s;return t=new Vt({props:{gameId:i[1]}}),{c(){e=E("div"),R(t.$$.fragment),this.h()},l(r){e=D(r,"DIV",{class:!0});var a=S(e);M(t.$$.fragment,a),a.forEach(c),this.h()},h(){w(e,"class","maintain-position svelte-19t4g5g")},m(r,a){I(r,e,a),q(t,e,null),s=!0},p(r,a){const o={};a&2&&(o.gameId=r[1]),t.$set(o)},i(r){s||(V(t.$$.fragment,r),ae(()=>{n&&n.end(1),l=ie(e,x,{x:500}),l.start()}),s=!0)},o(r){N(t.$$.fragment,r),l&&l.invalidate(),n=de(e,x,{x:-500}),s=!1},d(r){r&&c(e),L(t),r&&n&&n.end()}}}function Bt(i){let e,t,l,n,s;return t=new ut({}),{c(){e=E("div"),R(t.$$.fragment),this.h()},l(r){e=D(r,"DIV",{class:!0});var a=S(e);M(t.$$.fragment,a),a.forEach(c),this.h()},h(){w(e,"class","maintain-position svelte-19t4g5g")},m(r,a){I(r,e,a),q(t,e,null),s=!0},p:J,i(r){s||(V(t.$$.fragment,r),ae(()=>{n&&n.end(1),l=ie(e,x,{x:500}),l.start()}),s=!0)},o(r){N(t.$$.fragment,r),l&&l.invalidate(),n=de(e,x,{x:-500}),s=!1},d(r){r&&c(e),L(t),r&&n&&n.end()}}}function At(i){let e,t,l,n,s,r,a,o;const d=[Bt,Ot,Nt,Gt,Pt],f=[];function _(v,p){var h;return!v[0].uid||v[0].uid===""?0:v[1]!==""&&(!v[2]||((h=v[2])==null?void 0:h.state)==="waiting")?1:!v[2].id||v[2].id===""?2:v[2].state==="waiting"?3:4}return n=_(i),s=f[n]=d[n](i),a=new rt({props:{src:"https://upload.wikimedia.org/wikipedia/en/thumb/8/80/Wikipedia-logo-v2.svg/2560px-Wikipedia-logo-v2.svg.png",alt:"wikipedia logo"}}),{c(){e=E("div"),t=E("div"),l=E("div"),s.c(),r=B(),R(a.$$.fragment),this.h()},l(v){e=D(v,"DIV",{class:!0});var p=S(e);t=D(p,"DIV",{class:!0});var h=S(t);l=D(h,"DIV",{class:!0});var m=S(l);s.l(m),m.forEach(c),h.forEach(c),r=A(p),M(a.$$.fragment,p),p.forEach(c),this.h()},h(){w(l,"class","carousel svelte-19t4g5g"),w(t,"class","login svelte-19t4g5g"),w(e,"class","homepage svelte-19t4g5g")},m(v,p){I(v,e,p),T(e,t),T(t,l),f[n].m(l,null),T(e,r),q(a,e,null),o=!0},p(v,p){let h=n;n=_(v),n===h?f[n].p(v,p):(oe(),N(f[h],1,1,()=>{f[h]=null}),ue(),s=f[n],s?s.p(v,p):(s=f[n]=d[n](v),s.c()),V(s,1),s.m(l,null))},i(v){o||(V(s),V(a.$$.fragment,v),o=!0)},o(v){N(s),N(a.$$.fragment,v),o=!1},d(v){v&&c(e),f[n].d(),L(a)}}}function Rt(i){let e,t;return e=new nt({props:{backBtn:!1,$$slots:{default:[At]},$$scope:{ctx:i}}}),{c(){R(e.$$.fragment)},l(l){M(e.$$.fragment,l)},m(l,n){q(e,l,n),t=!0},p(l,[n]){const s={};n&15&&(s.$$scope={dirty:n,ctx:l}),e.$set(s)},i(l){t||(V(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){L(e,l)}}}function Mt(i,e,t){let l,n,s;return Y(i,Z,r=>t(0,l=r)),Y(i,$e,r=>t(1,n=r)),Y(i,K,r=>t(2,s=r)),[l,n,s]}class Yt extends le{constructor(e){super(),ne(this,e,Mt,Rt,re,{})}}export{Yt as O};
